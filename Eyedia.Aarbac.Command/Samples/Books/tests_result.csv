Id,Comment,Query,User,Role,Expected,ParsedQueryStage1,ParsedQuery,Records,Errors,TestResult
"1","Wildcard select, the user can see authors from NY and Charlotte","select * from Author","Lashawn","role_city_mgr","","SELECT Author.AuthorId , Author.Name , Author.SSN , Author.ZipCodeId  FROM Author   inner join [ZipCode] [t1] on [t1].ZipCodeId = [Author].ZipCodeId   inner join [City] [t2] on [t2].CityId = [t1].CityId WHERE t2.Name in { CityNames }  ","SELECT Author.AuthorId , Author.Name , Author.ZipCodeId FROM Author   inner join [ZipCode] [t1] on [t1].ZipCodeId = [Author].ZipCodeId   inner join [City] [t2] on [t2].CityId = [t1].CityId WHERE t2.Name in ('New York','Charlotte')  ","10 record(s)","","Passed"
"2","Specific columns select, the user can see authors from NY and Charlotte","select * from Author","Lashawn","role_city_mgr","","SELECT Author.AuthorId , Author.Name , Author.SSN , Author.ZipCodeId  FROM Author   inner join [ZipCode] [t5] on [t5].ZipCodeId = [Author].ZipCodeId   inner join [City] [t6] on [t6].CityId = [t5].CityId WHERE t6.Name in { CityNames }  ","SELECT Author.AuthorId , Author.Name , Author.ZipCodeId FROM Author   inner join [ZipCode] [t5] on [t5].ZipCodeId = [Author].ZipCodeId   inner join [City] [t6] on [t6].CityId = [t5].CityId WHERE t6.Name in ('New York','Charlotte')  ","10 record(s)","","Passed"
"3","Specific columns select, the user can see authors from NY and Charlotte","select * from Author a","Lashawn","role_city_mgr","","SELECT a.AuthorId , a.Name , a.SSN , a.ZipCodeId  FROM Author a   inner join [ZipCode] [t9] on [t9].ZipCodeId = [a].ZipCodeId   inner join [City] [t10] on [t10].CityId = [t9].CityId WHERE t10.Name in { CityNames }  ","SELECT a.AuthorId , a.Name , a.ZipCodeId FROM Author a   inner join [ZipCode] [t9] on [t9].ZipCodeId = [a].ZipCodeId   inner join [City] [t10] on [t10].CityId = [t9].CityId WHERE t10.Name in ('New York','Charlotte')  ","10 record(s)","","Passed"
"4","One specific column select, the user does not have permission to see the column","select SSN from Author","Lashawn","role_city_mgr","","SELECT SSN  FROM Author   inner join [ZipCode] [t13] on [t13].ZipCodeId = [Author].ZipCodeId   inner join [City] [t14] on [t14].CityId = [t13].CityId WHERE t14.Name in { CityNames }  ","SELECT 'null'  FROM Author   inner join [ZipCode] [t13] on [t13].ZipCodeId = [Author].ZipCodeId   inner join [City] [t14] on [t14].CityId = [t13].CityId WHERE t14.Name in ('New York','Charlotte')  ","0 record(s)","","Passed"
"5","Wildcard select, there is no restriction on Book table, user should see everything","select * from Book","Lashawn","role_city_mgr","","select Book.BookId,Book.Title,Book.Subject,Book.Price,Book.Isbn13,Book.Isbn10,Book.PublisherId from Book","select Book.BookId,Book.Title,Book.Subject,Book.Price,Book.Isbn13,Book.Isbn10,Book.PublisherId from Book","10 record(s)","","Passed"
"6","Wildcard select with alias","select a.* from Author a","Lashawn","role_city_mgr","","SELECT a.AuthorId , a.Name , a.SSN , a.ZipCodeId  FROM Author a   inner join [ZipCode] [t18] on [t18].ZipCodeId = [a].ZipCodeId   inner join [City] [t19] on [t19].CityId = [t18].CityId WHERE t19.Name in { CityNames }  ","SELECT a.AuthorId , a.Name , a.ZipCodeId FROM Author a   inner join [ZipCode] [t18] on [t18].ZipCodeId = [a].ZipCodeId   inner join [City] [t19] on [t19].CityId = [t18].CityId WHERE t19.Name in ('New York','Charlotte')  ","10 record(s)","","Passed"
"7","Wildcard select with only table alias","select * from Author a","Lashawn","role_city_mgr","","SELECT a.AuthorId , a.Name , a.SSN , a.ZipCodeId  FROM Author a   inner join [ZipCode] [t22] on [t22].ZipCodeId = [a].ZipCodeId   inner join [City] [t23] on [t23].CityId = [t22].CityId WHERE t23.Name in { CityNames }  ","SELECT a.AuthorId , a.Name , a.ZipCodeId FROM Author a   inner join [ZipCode] [t22] on [t22].ZipCodeId = [a].ZipCodeId   inner join [City] [t23] on [t23].CityId = [t22].CityId WHERE t23.Name in ('New York','Charlotte')  ","10 record(s)","","Passed"
"8","Wildcard muliselect with table alias","select a.*, a.* from Author a","Lashawn","role_city_mgr","","SELECT a.AuthorId , a.Name , a.SSN , a.ZipCodeId , a.AuthorId , a.Name , a.SSN , a.ZipCodeId  FROM Author a   inner join [ZipCode] [t26] on [t26].ZipCodeId = [a].ZipCodeId   inner join [City] [t27] on [t27].CityId = [t26].CityId WHERE t27.Name in { CityNames }  ","SELECT a.AuthorId , a.Name , a.ZipCodeId , a.AuthorId , a.Name , a.ZipCodeId FROM Author a   inner join [ZipCode] [t26] on [t26].ZipCodeId = [a].ZipCodeId   inner join [City] [t27] on [t27].CityId = [t26].CityId WHERE t27.Name in ('New York','Charlotte')  ","10 record(s)","","Passed"
"9","Complex wildcard select","select * from Author where Author.ZipCodeId in (select zc.ZipCodeId from ZipCode zc where zc.CityId in (select c.CityId from City c where c.StateId in (select StateId from State where ShortName in ('NY', 'NC'))))","Lashawn","role_city_mgr","","SELECT Author.AuthorId , Author.Name , Author.SSN , Author.ZipCodeId  FROM Author   inner join [ZipCode] [t30] on [t30].ZipCodeId = [Author].ZipCodeId   inner join [City] [t31] on [t31].CityId = [t30].CityId WHERE (Author.ZipCodeId in (SELECT zc.ZipCodeId  FROM ZipCode zc  WHERE zc.CityId in (SELECT c.CityId  FROM City c  WHERE c.StateId in (SELECT StateId  FROM State  WHERE ShortName in ('NY'  , 'NC' ) ) ) )) AND (t31.Name in { CityNames })  ","SELECT Author.AuthorId , Author.Name , Author.ZipCodeId FROM Author   inner join [ZipCode] [t30] on [t30].ZipCodeId = [Author].ZipCodeId   inner join [City] [t31] on [t31].CityId = [t30].CityId WHERE (Author.ZipCodeId in (SELECT zc.ZipCodeId  FROM ZipCode zc  WHERE zc.CityId in (SELECT c.CityId  FROM City c  WHERE c.StateId in (SELECT StateId  FROM State  WHERE ShortName in ('NY'  , 'NC' ) ) ) )) AND (t31.Name in ('New York','Charlotte'))  ","10 record(s)","","Passed"
"10","Select into wildcard","select * into Author2 from Author","Lashawn","role_city_mgr","","SELECT Author.AuthorId , Author.Name , Author.SSN , Author.ZipCodeId into Author2  FROM Author   inner join [ZipCode] [t34] on [t34].ZipCodeId = [Author].ZipCodeId   inner join [City] [t35] on [t35].CityId = [t34].CityId WHERE t35.Name in { CityNames }  ","SELECT Author.AuthorId , Author.Name , Author.ZipCodeId into Author2  FROM Author   inner join [ZipCode] [t34] on [t34].ZipCodeId = [Author].ZipCodeId   inner join [City] [t35] on [t35].CityId = [t34].CityId WHERE t35.Name in ('New York','Charlotte')  ","0 record(s)","","Passed"
"11","select into specific columns","select name,ssn into Author2 from Author","Lashawn","role_city_mgr","Ambiguous column name 'name'.
","SELECT name , ssn into Author2  FROM Author   inner join [ZipCode] [t38] on [t38].ZipCodeId = [Author].ZipCodeId   inner join [City] [t39] on [t39].CityId = [t38].CityId WHERE t39.Name in { CityNames }  ","SELECT name   into Author2  FROM Author   inner join [ZipCode] [t38] on [t38].ZipCodeId = [Author].ZipCodeId   inner join [City] [t39] on [t39].CityId = [t38].CityId WHERE t39.Name in ('New York','Charlotte')  ","Errored","Ambiguous column name 'name'.
","Passed"
"12","select into specific columns recommended way","select Author.name, Author.ssn into Author2 from Author","Lashawn","role_city_mgr","","SELECT Author.name , Author.ssn into Author2  FROM Author   inner join [ZipCode] [t42] on [t42].ZipCodeId = [Author].ZipCodeId   inner join [City] [t43] on [t43].CityId = [t42].CityId WHERE t43.Name in { CityNames }  ","SELECT Author.name   into Author2  FROM Author   inner join [ZipCode] [t42] on [t42].ZipCodeId = [Author].ZipCodeId   inner join [City] [t43] on [t43].CityId = [t42].CityId WHERE t43.Name in ('New York','Charlotte')  ","Errored","There is already an object named 'Author2' in the database.
","Failed"
"13","Select using inner join 1","select a.AuthorId, a.Name as [AuthorName], a.ZipCodeId, c.Name as City from Author a
inner join Zipcode zc on zc.ZipCodeId = a.ZipCodeId
inner join City c on c.CityId = zc.CityId
where c.Name = 'Charlotte'","Lashawn","role_city_mgr","","SELECT a.AuthorId , a.Name as [AuthorName] , a.ZipCodeId , c.Name as City  FROM Author a inner join Zipcode zc on zc.ZipCodeId = a.ZipCodeId inner join City c on c.CityId = zc.CityId   WHERE c.Name in { CityNames }  ","SELECT a.AuthorId , a.Name as [AuthorName] , a.ZipCodeId , c.Name as City  FROM Author a inner join Zipcode zc on zc.ZipCodeId = a.ZipCodeId inner join City c on c.CityId = zc.CityId   WHERE c.Name in ('New York','Charlotte')  ","10 record(s)","","Passed"
"14","Select using inner join 2","select zc.ZipCode, a.Name from ZipCode zc inner join Author a on a.ZipCodeId = zc.ZipCodeId where zc.ZipCodeId = 12","Lashawn","role_city_mgr","","SELECT zc.ZipCode , a.Name  FROM ZipCode zc inner join Author a on a.ZipCodeId = zc.ZipCodeId    inner join [City] [t48] on [t48].CityId = [zc].CityId WHERE (zc.ZipCodeId = 12) AND (t48.Name in { CityNames })  ","SELECT zc.ZipCode , a.Name  FROM ZipCode zc inner join Author a on a.ZipCodeId = zc.ZipCodeId    inner join [City] [t48] on [t48].CityId = [zc].CityId WHERE (zc.ZipCodeId = 12) AND (t48.Name in ('New York','Charlotte'))  ","0 record(s)","","Passed"
"15","aarbac recommends to use table or alias prefix, this query will parse good, but will throw error while executing ```Ambiguous column name 'ZipCodeId'```","select * from Author where ZipCodeId in (select zc.ZipCodeId from ZipCode zc where zc.CityId in (select c.CityId from City c where c.StateId in (select StateId from State where ShortName in ('NY', 'NC'))))","Lashawn","role_city_mgr","Ambiguous column name 'ZipCodeId'.
","SELECT Author.AuthorId , Author.Name , Author.SSN , Author.ZipCodeId  FROM Author   inner join [ZipCode] [t51] on [t51].ZipCodeId = [Author].ZipCodeId   inner join [City] [t52] on [t52].CityId = [t51].CityId WHERE (ZipCodeId in (SELECT zc.ZipCodeId  FROM ZipCode zc  WHERE zc.CityId in (SELECT c.CityId  FROM City c  WHERE c.StateId in (SELECT StateId  FROM State  WHERE ShortName in ('NY'  , 'NC' ) ) ) )) AND (t52.Name in { CityNames })  ","SELECT Author.AuthorId , Author.Name , Author.ZipCodeId FROM Author   inner join [ZipCode] [t51] on [t51].ZipCodeId = [Author].ZipCodeId   inner join [City] [t52] on [t52].CityId = [t51].CityId WHERE (ZipCodeId in (SELECT zc.ZipCodeId  FROM ZipCode zc  WHERE zc.CityId in (SELECT c.CityId  FROM City c  WHERE c.StateId in (SELECT StateId  FROM State  WHERE ShortName in ('NY'  , 'NC' ) ) ) )) AND (t52.Name in ('New York','Charlotte'))  ","Errored","Ambiguous column name 'ZipCodeId'.
","Passed"
"16","aarbac recommended column usage","select * from Author where Author.ZipCodeId in (select zc.ZipCodeId from ZipCode zc where zc.CityId in (select c.CityId from City c where c.StateId in (select StateId from State where ShortName in ('NY', 'NC'))))","Lashawn","role_city_mgr","","SELECT Author.AuthorId , Author.Name , Author.SSN , Author.ZipCodeId  FROM Author   inner join [ZipCode] [t55] on [t55].ZipCodeId = [Author].ZipCodeId   inner join [City] [t56] on [t56].CityId = [t55].CityId WHERE (Author.ZipCodeId in (SELECT zc.ZipCodeId  FROM ZipCode zc  WHERE zc.CityId in (SELECT c.CityId  FROM City c  WHERE c.StateId in (SELECT StateId  FROM State  WHERE ShortName in ('NY'  , 'NC' ) ) ) )) AND (t56.Name in { CityNames })  ","SELECT Author.AuthorId , Author.Name , Author.ZipCodeId FROM Author   inner join [ZipCode] [t55] on [t55].ZipCodeId = [Author].ZipCodeId   inner join [City] [t56] on [t56].CityId = [t55].CityId WHERE (Author.ZipCodeId in (SELECT zc.ZipCodeId  FROM ZipCode zc  WHERE zc.CityId in (SELECT c.CityId  FROM City c  WHERE c.StateId in (SELECT StateId  FROM State  WHERE ShortName in ('NY'  , 'NC' ) ) ) )) AND (t56.Name in ('New York','Charlotte'))  ","10 record(s)","","Passed"
"17","incorrect query","select","Lashawn","role_city_mgr","Incorrect syntax near select.Error:Incorrect syntax near select. at line nr:1 column:1 ","select","select","","Incorrect syntax near select.Error:Incorrect syntax near select. at line nr:1 column:1 ","Passed"
"18","incorrect query","abc","Lashawn","role_city_mgr","RBAC.Core - Invalid query type!","","","","RBAC.Core - Invalid query type!","Passed"
"19","incorrect query","select * ","Lashawn","role_city_mgr","Must specify table to select from.
","select * ","select * ","Errored","Must specify table to select from.
","Passed"
"20","incorrect query","select * from ","Lashawn","role_city_mgr","Unexpected end of file occurred.Error:Unexpected end of file occurred. at line nr:1 column:15 ","select * from ","select * from ","","Unexpected end of file occurred.Error:Unexpected end of file occurred. at line nr:1 column:15 ","Passed"
"21","incorrect query","select * from book where","Lashawn","role_city_mgr","Unexpected end of file occurred.Error:Unexpected end of file occurred. at line nr:1 column:25 ","select * from book where","select * from book where","","Unexpected end of file occurred.Error:Unexpected end of file occurred. at line nr:1 column:25 ","Passed"
"22","incorrect table","select * from abc","Lashawn","role_city_mgr","RBAC.PRS - The referred table abc was not found in meta data!","","","","RBAC.PRS - The referred table abc was not found in meta data!","Passed"
"23","Simple Insert","insert into Author values ('','',1)","Lashawn","role_city_mgr","RBAC.PRS - User 'Lashawn' does not have permission to insert record into the table 'Author'!","","","","RBAC.PRS - User 'Lashawn' does not have permission to insert record into the table 'Author'!","Passed"
"24","Simple insert with specific column names","insert into Author(Name,SSN,ZipCodeId) values ('','',1)","Lashawn","role_city_mgr","RBAC.PRS - User 'Lashawn' does not have permission to insert record into the table 'Author'!","","","","RBAC.PRS - User 'Lashawn' does not have permission to insert record into the table 'Author'!","Passed"
"25","Simple update, Lashawn has permission to update Name","update Author set Name='abc' where AuthorId = 1","Lashawn","role_city_mgr","","","","","RBAC.PRS - User 'Lashawn' does not have permission to update table 'Author'!","Failed"
"26","Simple update, Lashawn does not have permission to update SSN","update Author set SSN='abc' where AuthorId = 1","Lashawn","role_city_mgr","RBAC.PRS - User 'Lashawn' has permission to update table 'Author', however has no permission to update column 'SSN'!","","","","RBAC.PRS - User 'Lashawn' does not have permission to update table 'Author'!","Failed"
"27","Update with Join Clause","UPDATE a 
SET a.Name = 'abc' 
FROM dbo.Author AS a
INNER JOIN dbo.ZipCode AS zc 
       ON a.ZipCodeId = a.ZipCodeId
WHERE zc.ZipCode = '00000' ","Lashawn","role_city_mgr","","","","","RBAC.PRS - User 'Lashawn' does not have permission to update table 'Author'!","Failed"
"28","simple delete","delete from author where name = 'abc'","Lashawn","role_city_mgr","","delete from author where name = 'abc'","delete from author where name = 'abc'","","","Passed"
